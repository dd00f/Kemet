Deeplearning4j OOM Exception Encountered for ComputationGraph
Timestamp:                              2019-09-03 18:04:16.423
Thread ID                               1
Thread Name                             main


Stack Trace:
java.lang.OutOfMemoryError: Cannot allocate new LongPointer(8): totalBytes = 3204M, physicalBytes = 8204M
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:76)
	at org.nd4j.linalg.api.buffer.BaseDataBuffer.<init>(BaseDataBuffer.java:622)
	at org.nd4j.linalg.api.buffer.BaseDataBuffer.<init>(BaseDataBuffer.java:591)
	at org.nd4j.linalg.api.buffer.LongBuffer.<init>(LongBuffer.java:45)
	at org.nd4j.linalg.cpu.nativecpu.CpuTADManager.getTADOnlyShapeInfo(CpuTADManager.java:92)
	at org.nd4j.linalg.cpu.nativecpu.ops.NativeOpExecutioner.exec(NativeOpExecutioner.java:940)
	at org.nd4j.linalg.api.ndarray.BaseNDArray.applyBroadcastOp(BaseNDArray.java:3083)
	at org.nd4j.linalg.api.ndarray.BaseNDArray.doRowWise(BaseNDArray.java:3066)
	at org.nd4j.linalg.api.ndarray.BaseNDArray.addiRowVector(BaseNDArray.java:3376)
	at org.deeplearning4j.nn.layers.BaseLayer.preOutput(BaseLayer.java:308)
	at org.deeplearning4j.nn.layers.BaseLayer.activate(BaseLayer.java:320)
	at org.deeplearning4j.nn.graph.vertex.impl.LayerVertex.doForward(LayerVertex.java:110)
	at org.deeplearning4j.nn.graph.ComputationGraph.ffToLayerActivationsInWS(ComputationGraph.java:2080)
	at org.deeplearning4j.nn.graph.ComputationGraph.computeGradientAndScore(ComputationGraph.java:1360)
	at org.deeplearning4j.nn.graph.ComputationGraph.computeGradientAndScore(ComputationGraph.java:1329)
	at org.deeplearning4j.optimize.solvers.BaseOptimizer.gradientAndScore(BaseOptimizer.java:160)
	at org.deeplearning4j.optimize.solvers.StochasticGradientDescent.optimize(StochasticGradientDescent.java:63)
	at org.deeplearning4j.optimize.Solver.optimize(Solver.java:52)
	at org.deeplearning4j.nn.graph.ComputationGraph.fitHelper(ComputationGraph.java:1149)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1098)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1065)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1025)
	at kemet.ai.KemetNeuralNetwork.train(KemetNeuralNetwork.java:109)
	at kemet.data.KemetLearnExperiment.runTrainingExercise(KemetLearnExperiment.java:203)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseLayerCount(KemetLearnExperiment.java:196)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseNeuralLayerSize(KemetLearnExperiment.java:183)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseNestrovLearnRate(KemetLearnExperiment.java:160)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseNestrovMomentum(KemetLearnExperiment.java:154)
	at kemet.data.KemetLearnExperiment.learn(KemetLearnExperiment.java:133)
	at kemet.data.KemetLearnExperiment.main(KemetLearnExperiment.java:80)
Caused by: java.lang.OutOfMemoryError: Physical memory usage is too high: physicalBytes (8204M) > maxPhysicalBytes (8176M)
	at org.bytedeco.javacpp.Pointer.deallocator(Pointer.java:584)
	at org.bytedeco.javacpp.Pointer.init(Pointer.java:124)
	at org.bytedeco.javacpp.LongPointer.allocateArray(Native Method)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:68)
	... 29 more


<Error generating network memory status information section>java.lang.OutOfMemoryError: Cannot allocate new LongPointer(8): totalBytes = 3399M, physicalBytes = 8361M
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:76)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:41)
	at org.nd4j.linalg.api.buffer.BaseDataBuffer.<init>(BaseDataBuffer.java:385)
	at org.nd4j.linalg.api.buffer.LongBuffer.<init>(LongBuffer.java:81)
	at org.nd4j.linalg.api.buffer.factory.DefaultDataBufferFactory.createLong(DefaultDataBufferFactory.java:436)
	at org.nd4j.linalg.api.buffer.factory.DefaultDataBufferFactory.createLong(DefaultDataBufferFactory.java:431)
	at org.nd4j.linalg.factory.Nd4j.createBufferDetached(Nd4j.java:1462)
	at org.nd4j.linalg.api.shape.Shape.createShapeInformation(Shape.java:3223)
	at org.nd4j.linalg.api.ndarray.BaseShapeInfoProvider.createShapeInformation(BaseShapeInfoProvider.java:94)
	at org.nd4j.linalg.cpu.nativecpu.DirectShapeInfoProvider.createShapeInformation(DirectShapeInfoProvider.java:102)
	at org.nd4j.linalg.cpu.nativecpu.DirectShapeInfoProvider.createShapeInformation(DirectShapeInfoProvider.java:78)
	at org.nd4j.linalg.api.ndarray.BaseNDArray.<init>(BaseNDArray.java:185)
	at org.nd4j.linalg.cpu.nativecpu.NDArray.<init>(NDArray.java:81)
	at org.nd4j.linalg.cpu.nativecpu.CpuNDArrayFactory.create(CpuNDArrayFactory.java:299)
	at org.nd4j.linalg.factory.Nd4j.create(Nd4j.java:3945)
	at org.nd4j.linalg.api.shape.Shape.newShapeNoCopy(Shape.java:2046)
	at org.nd4j.linalg.learning.NesterovsUpdater.setStateViewArray(NesterovsUpdater.java:55)
	at org.nd4j.linalg.learning.config.Nesterovs.instantiate(Nesterovs.java:98)
	at org.deeplearning4j.nn.updater.UpdaterBlock.init(UpdaterBlock.java:93)
	at org.deeplearning4j.nn.updater.BaseMultiLayerUpdater.<init>(BaseMultiLayerUpdater.java:179)
	at org.deeplearning4j.nn.updater.graph.ComputationGraphUpdater.<init>(ComputationGraphUpdater.java:44)
	at org.deeplearning4j.nn.updater.graph.ComputationGraphUpdater.<init>(ComputationGraphUpdater.java:40)
	at org.deeplearning4j.optimize.solvers.BaseOptimizer.getComputationGraphUpdater(BaseOptimizer.java:134)
	at org.deeplearning4j.nn.graph.ComputationGraph.getUpdater(ComputationGraph.java:2839)
	at org.deeplearning4j.util.CrashReportingUtil.generateMemoryStatus(CrashReportingUtil.java:281)
	at org.deeplearning4j.util.CrashReportingUtil.writeMemoryCrashDump(CrashReportingUtil.java:160)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1100)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1065)
	at org.deeplearning4j.nn.graph.ComputationGraph.fit(ComputationGraph.java:1025)
	at kemet.ai.KemetNeuralNetwork.train(KemetNeuralNetwork.java:109)
	at kemet.data.KemetLearnExperiment.runTrainingExercise(KemetLearnExperiment.java:203)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseLayerCount(KemetLearnExperiment.java:196)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseNeuralLayerSize(KemetLearnExperiment.java:183)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseNestrovLearnRate(KemetLearnExperiment.java:160)
	at kemet.data.KemetLearnExperiment.runTrainingExerciseNestrovMomentum(KemetLearnExperiment.java:154)
	at kemet.data.KemetLearnExperiment.learn(KemetLearnExperiment.java:133)
	at kemet.data.KemetLearnExperiment.main(KemetLearnExperiment.java:80)
Caused by: java.lang.OutOfMemoryError: Physical memory usage is too high: physicalBytes (8361M) > maxPhysicalBytes (8176M)
	at org.bytedeco.javacpp.Pointer.deallocator(Pointer.java:584)
	at org.bytedeco.javacpp.Pointer.init(Pointer.java:124)
	at org.bytedeco.javacpp.LongPointer.allocateArray(Native Method)
	at org.bytedeco.javacpp.LongPointer.<init>(LongPointer.java:68)
	... 36 more
